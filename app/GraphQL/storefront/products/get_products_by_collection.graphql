query getCollectionProducts(
  $handle: String!
  $limit: Int!
  $after: String
  $sortKey: ProductCollectionSortKeys
  $reverse: Boolean
) {
  collectionByHandle(handle: $handle) {
    id
    title
    handle
    description
    updatedAt

    image {
      url
      altText
    }

    products(
      first: $limit
      after: $after
      sortKey: $sortKey
      reverse: $reverse
    ) {
      edges {
        cursor
        node {
          id
          title
          handle
          description
          descriptionHtml
          vendor
          productType
          tags
          availableForSale
          totalInventory
          publishedAt
          updatedAt
          onlineStoreUrl

          options {
            id
            name
            values
          }

          images(first: 250) {
            edges {
              node {
                id
                url
                altText
                width
                height
              }
            }
          }

          variants(first: 250) {
            edges {
              node {
                id
                title
                sku
                availableForSale
                quantityAvailable
                weight
                weightUnit

                selectedOptions {
                  name
                  value
                }

                price {
                  amount
                  currencyCode
                }

                compareAtPrice {
                  amount
                  currencyCode
                }

                compareAtPriceV2 {
                  amount
                  currencyCode
                }

                image {
                  url
                  altText
                }
              }
            }
          }

          collections(first: 250) {
            edges {
              node {
                id
                handle
                title
              }
            }
          }
        }
      }

      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
}
